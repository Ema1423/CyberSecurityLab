<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Malware Analyzer</title>

    <style>
        body {
            margin: 0;
            padding: 0;
            color: #fff;
            font-family: Arial, sans-serif;
            direction: rtl;
        }

        /* Ø®Ù„ÙÙŠØ© Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (Ù†ÙØ³ Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…) */
        #bgVideo {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -1;
        }

        .container {
            max-width: 800px;
            margin: 80px auto;
            padding: 25px;
            background: rgba(0, 140, 255, 0.25);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(0, 140, 255, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        h2 {
            text-align: center;
            margin-bottom: 15px;
            text-shadow: 0 0 10px #0099ff;
        }

        p.desc {
            text-align: center;
            margin-bottom: 25px;
            font-size: 14px;
            opacity: 0.9;
        }

        input {
            width: 100%;
            padding: 12px;
            margin: 10px 0 15px 0;
            border-radius: 8px;
            border: none;
            font-size: 15px;
        }

        button {
            background: #0099ff;
            border: none;
            padding: 12px 20px;
            color: #fff;
            cursor: pointer;
            border-radius: 8px;
            font-size: 16px;
            transition: 0.3s;
        }

        button:hover {
            background: #0ab1ff;
        }

        .btn-row {
            text-align: center;
            margin-bottom: 20px;
        }

        .result-box {
            margin-top: 15px;
            padding: 15px;
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.25);
            font-size: 14px;
            line-height: 1.6;
        }

        .risk-high {
            border: 1px solid #ff4444;
        }

        .risk-medium {
            border: 1px solid #ffbb33;
        }

        .risk-low {
            border: 1px solid #00c851;
        }

        .hint {
            margin-top: 10px;
            font-size: 12px;
            opacity: 0.8;
        }
    </style>
</head>

<body>

    <!-- Ø§Ù„Ø®Ù„ÙÙŠØ© (Ù†ÙØ³ Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…) -->
    <video autoplay muted loop id="bgVideo">
        <source src="videos2/scanner-bg.mp4" type="video/mp4" />
    </video>

    <div class="container">
        <h2>ğŸ§ª Malware & Suspicious File Analyzer</h2>
        <p class="desc">
            Ø§ÙƒØªØ¨ Ø±Ø§Ø¨Ø· (URL) Ø£Ùˆ Ø§Ø³Ù… Ù…Ù„Ù Ù…Ø«Ù„: <b>setup.exe</b> Ø£Ùˆ <b>invoice.docm</b>  
            ÙˆØ§Ù„Ø£Ø¯Ø§Ø© ØªØ­Ù„Ù„ Ø§Ù„Ø¥Ù…ØªØ¯Ø§Ø¯ ÙˆØ´ÙƒÙ„ Ø§Ù„Ø±Ø§Ø¨Ø· ÙˆØªØ­Ø¯Ø¯ Ù‡Ù„ Ù‡Ùˆ Ø¢Ù…Ù† Ø£Ùˆ Ù…Ø´Ø¨ÙˆÙ‡ Ø£Ùˆ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø®Ø·ÙˆØ±Ø©.
        </p>

        <input
            type="text"
            id="malInput"
            placeholder="Ø£Ø¯Ø®Ù„ Ø±Ø§Ø¨Ø· Ø£Ùˆ Ø§Ø³Ù… Ù…Ù„Ù Ù…Ø«Ù„: C:\\Downloads\\setup.exe Ø£Ùˆ https://example.com/file.zip"
        />

        <div class="btn-row">
            <button onclick="analyzeMalware()">ØªØ­Ù„ÙŠÙ„</button>
        </div>

        <div id="malResult" class="result-box">
            ğŸ” Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø¨Ø¹Ø¯ â€“ Ø£Ø¯Ø®Ù„ Ø±Ø§Ø¨Ø· Ø£Ùˆ Ø§Ø³Ù… Ù…Ù„Ù Ø«Ù… Ø§Ø¶ØºØ· "ØªØ­Ù„ÙŠÙ„".
        </div>

        <p class="hint">
            âš  Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø© ØªØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ù‚ÙˆØ§Ø¹Ø¯ Ø¨Ø³ÙŠØ·Ø© (Ø§Ù…ØªØ¯Ø§Ø¯Ø§Øª + Ø´ÙƒÙ„ Ø§Ù„Ø±Ø§Ø¨Ø·)ØŒ ÙˆÙ„ÙŠØ³Øª Ø¨Ø±Ù†Ø§Ù…Ø¬ Ù…ÙƒØ§ÙØ­Ø© ÙÙŠØ±ÙˆØ³Ø§Øª Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ù„ÙƒÙ†Ù‡Ø§ Ù…Ù…ØªØ§Ø²Ø© Ù„Ù„ØªØ¯Ø±ÙŠØ¨ ÙˆØ§Ù„Ø¹Ø±Ø¶ ÙÙŠ Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ù€ Cyber Lab.
        </p>
    </div>

    <script>
        function analyzeMalware() {
            const input = document.getElementById("malInput").value.trim();
            const resultBox = document.getElementById("malResult");

            if (!input) {
                resultBox.className = "result-box risk-medium";
                resultBox.innerHTML = "â— Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· Ø£Ùˆ Ø§Ø³Ù… Ù…Ù„Ù Ø£ÙˆÙ„Ø§Ù‹.";
                return;
            }

            let details = [];
            let score = 0;
            let type = "";

            // Ù‡Ù„ Ù‡Ùˆ URL ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹ØŸ
            const looksLikeUrl =
                input.startsWith("http://") ||
                input.startsWith("https://") ||
                input.includes("www.") ||
                input.includes(".com") ||
                input.includes(".net") ||
                input.includes(".org");

            // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù…ØªØ¯Ø§Ø¯Ø§Øª Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø®Ø·ÙˆØ±Ø©
            const highRiskExt = [
                ".exe", ".scr", ".js", ".vbs", ".bat", ".cmd", ".ps1",
                ".jar", ".apk", ".msi", ".dll", ".com", ".pif", ".cpl",
                ".php", ".asp", ".aspx", ".jsp", ".sh"
            ];

            // Ø§Ù…ØªØ¯Ø§Ø¯Ø§Øª Ù…Ø³ØªÙ†Ø¯Ø§Øª Ù…Ø§ÙƒØ±Ùˆ ØºØ§Ù„Ø¨Ø§Ù‹ ØªØ³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„Ù…Ø§Ù„ÙˆÙŠØ±
            const macroDocs = [
                ".docm", ".xlsm", ".pptm"
            ];

            // Ø£Ø±Ø´ÙŠÙØ§Øª Ù‚Ø¯ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ù„ÙØ§Øª Ø®Ø¨ÙŠØ«Ø©
            const archiveExt = [
                ".zip", ".rar", ".7z", ".iso", ".img", ".bin"
            ];

            // Ø¥Ø°Ø§ Ø´ÙƒÙ„Ù‡ URL
            if (looksLikeUrl) {
                type = "url";
                details.push("ğŸ”— ØªÙ… Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„ÙŠÙ‡ ÙƒØ±Ø§Ø¨Ø· (URL).");

                // HTTP Ø¨Ø¯ÙˆÙ† ØªØ´ÙÙŠØ±
                if (input.startsWith("http://")) {
                    score += 2;
                    details.push("âš  ÙŠØ³ØªØ®Ø¯Ù… <b>HTTP</b> Ø¨Ø¯ÙˆÙ† ØªØ´ÙÙŠØ± (ØºÙŠØ± Ø¢Ù…Ù†).");
                } else if (input.startsWith("https://")) {
                    details.push("âœ… ÙŠØ³ØªØ®Ø¯Ù… <b>HTTPS</b> (Ø£ÙØ¶Ù„ ÙˆØ£ÙƒØ«Ø± Ø£Ù…Ø§Ù†Ø§Ù‹).");
                }

                // Ø±Ø§Ø¨Ø· Ù…Ø¨Ù†ÙŠ Ø¹Ù„Ù‰ IP (Ù…Ø«Ù„Ø§Ù‹ http://192.168.1.10)
                const ipPattern = /https?:\/\/\d{1,3}(\.\d{1,3}){3}/;
                if (ipPattern.test(input)) {
                    score += 2;
                    details.push("âš  Ø§Ù„Ø±Ø§Ø¨Ø· ÙŠØ³ØªØ®Ø¯Ù… Ø¹Ù†ÙˆØ§Ù† IP Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ø³Ù… Ù†Ø·Ø§Ù‚ â€“ Ø´Ø§Ø¦Ø¹ ÙÙŠ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø®Ø¨ÙŠØ«Ø©.");
                }

                // Ù†Ø·Ø§Ù‚Ø§Øª Ù…Ø´Ø¨ÙˆÙ‡Ø©
                const suspiciousTlds = [
                    ".ru", ".cn", ".tk", ".top", ".xyz", ".zip", ".mov",
                    ".click", ".support", ".monster"
                ];
                const lower = input.toLowerCase();
                for (let tld of suspiciousTlds) {
                    if (lower.includes(tld)) {
                        score += 2;
                        details.push(`âš  Ø§Ù„Ù†Ø·Ø§Ù‚ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù…ØªØ¯Ø§Ø¯ Ù…Ø´Ø¨ÙˆÙ‡: <b>${tld}</b>.`);
                        break;
                    }
                }

                // ÙˆØ¬ÙˆØ¯ @ ÙÙŠ Ø§Ù„Ø±Ø§Ø¨Ø· â€“ Ø£Ø­ÙŠØ§Ù†Ø§Ù‹ ØªØ³ØªØ®Ø¯Ù… Ù„Ø®Ø¯Ø§Ø¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                if (input.includes("@")) {
                    score += 2;
                    details.push("âš  ÙˆØ¬ÙˆØ¯ Ø±Ù…Ø² <b>@</b> ÙÙŠ Ø§Ù„Ø±Ø§Ø¨Ø· Ù‚Ø¯ ÙŠØ´ÙŠØ± Ø¥Ù„Ù‰ Ù…Ø­Ø§ÙˆÙ„Ø© Ø®Ø¯Ø§Ø¹ (phishing).");
                }

                // ÙˆØ¬ÙˆØ¯ ÙƒØ«ÙŠØ± Ù…Ù† Ø§Ù„Ø±Ù…ÙˆØ² Ø£Ùˆ Ø§Ù„Ø¨Ø±Ø³Ù†Øª %
                const percentCount = (input.match(/%/g) || []).length;
                if (percentCount >= 3) {
                    score += 1;
                    details.push("âš  Ø§Ù„Ø±Ø§Ø¨Ø· ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø§Ù„ÙƒØ«ÙŠØ± Ù…Ù† Ø§Ù„Ø£Ø­Ø±Ù Ø§Ù„Ù…Ø´ÙØ±Ø© (%XX) â€“ Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ø®ÙØ§Ø¡ Ø­Ù‚ÙŠÙ‚ÙŠØ© Ø§Ù„Ø±Ø§Ø¨Ø·.");
                }
            } else {
                // Ù†ØªØ¹Ø§Ù…Ù„ Ù…Ø¹Ù‡ ÙƒÙ€ "Ø§Ø³Ù… Ù…Ù„Ù"
                type = "file";
                details.push("ğŸ“„ ØªÙ… Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„ÙŠÙ‡ ÙƒØ§Ø³Ù… Ù…Ù„Ù Ø£Ùˆ Ù…Ø³Ø§Ø±.");

                const lowerName = input.toLowerCase();
                const extMatch = lowerName.match(/\.[a-z0-9]+$/i);
                if (extMatch) {
                    const ext = extMatch[0];
                    details.push(`ğŸ” Ø§Ù…ØªØ¯Ø§Ø¯ Ø§Ù„Ù…Ù„Ù: <b>${ext}</b>`);

                    if (highRiskExt.includes(ext)) {
                        score += 4;
                        details.push("ğŸš¨ Ø§Ù…ØªØ¯Ø§Ø¯ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø®Ø·ÙˆØ±Ø© â€“ ØºØ§Ù„Ø¨Ø§Ù‹ Ù…Ù„ÙØ§Øª ØªÙ†ÙÙŠØ°ÙŠØ© ØªÙØ³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„Ù…Ø§Ù„ÙˆÙŠØ±.");
                    } else if (macroDocs.includes(ext)) {
                        score += 3;
                        details.push("âš  Ù…Ø³ØªÙ†Ø¯ Ù…Ø§ÙƒØ±Ùˆ (Word / Excel / PowerPoint) â€“ Ø´Ø§Ø¦Ø¹ ÙÙŠ Ø§Ù„Ù‡Ø¬Ù…Ø§Øª Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ù…Ø§ÙƒØ±Ùˆ.");
                    } else if (archiveExt.includes(ext)) {
                        score += 2;
                        details.push("âš  Ù…Ù„Ù Ù…Ø¶ØºÙˆØ· Ø£Ùˆ ØµÙˆØ±Ø© Ù‚Ø±Øµ â€“ Ù‚Ø¯ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ù„ÙØ§Øª Ø®Ø¨ÙŠØ«Ø© Ø¨Ø¯Ø§Ø®Ù„Ù‡.");
                    } else {
                        details.push("âœ… Ø§Ù„Ø§Ù…ØªØ¯Ø§Ø¯ Ù„ÙŠØ³ Ù…Ù† Ø§Ù„Ø§Ù…ØªØ¯Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ø§Ø¦Ø¹Ø© ÙÙŠ Ø§Ù„Ù…Ø§Ù„ÙˆÙŠØ± â€“ Ù„ÙƒÙ† Ù„Ø§ ÙŠØ¹Ù†ÙŠ Ø£Ù†Ù‡ Ø¢Ù…Ù† 100%.");
                    }
                } else {
                    details.push("â„¹ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù…ØªØ¯Ø§Ø¯ ÙˆØ§Ø¶Ø­ ÙÙŠ Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù.");
                }

                // ÙƒÙ„Ù…Ø§Øª Ù…Ø´Ø¨ÙˆÙ‡Ø© ÙÙŠ Ø§Ù„Ø§Ø³Ù…
                const suspiciousWords = ["crack", "keygen", "nulled", "free", "patch"];
                for (let w of suspiciousWords) {
                    if (lowerName.includes(w)) {
                        score += 2;
                        details.push(`âš  Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ÙƒÙ„Ù…Ø© Ù…Ø´Ø¨ÙˆÙ‡Ø©: <b>${w}</b>.`);
                        break;
                    }
                }
            }

            // ØªØµÙ†ÙŠÙ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø®Ø·ÙˆØ±Ø©
            let riskClass = "risk-low";
            let riskLabel = "âœ… Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø®Ø·ÙˆØ±Ø©: Ù…Ù†Ø®ÙØ¶ (ØºØ§Ù„Ø¨Ø§Ù‹ Ø¢Ù…Ù†ØŒ Ù„ÙƒÙ† Ø¯Ø§Ø¦Ù…Ø§Ù‹ ØªØ­Ù‚Ù‚ÙŠ Ø¨Ù…Ø¶Ø§Ø¯ ÙÙŠØ±ÙˆØ³Ø§Øª Ø­Ù‚ÙŠÙ‚ÙŠ).";

            if (score >= 5) {
                riskClass = "risk-high";
                riskLabel = "ğŸš¨ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø®Ø·ÙˆØ±Ø©: Ø¹Ø§Ù„ÙŠ Ø¬Ø¯Ø§Ù‹ â€“ Ù„Ø§ ØªÙØªØ­ÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù / Ø§Ù„Ø±Ø§Ø¨Ø· Ø¥Ù„Ø§ Ø¨Ø¹Ø¯ ÙØ­ØµÙ‡ Ø¨Ø£Ø¯Ø§Ø© Ù…ÙˆØ«ÙˆÙ‚Ø©.";
            } else if (score >= 3) {
                riskClass = "risk-medium";
                riskLabel = "âš  Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø®Ø·ÙˆØ±Ø©: Ù…ØªÙˆØ³Ø· / Ù…Ø´Ø¨ÙˆÙ‡ â€“ ÙŠÙØ¶Ù„ ÙØ­ØµÙ‡ Ù‚Ø¨Ù„ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù….";
            }

            resultBox.className = "result-box " + riskClass;
            resultBox.innerHTML = `
                <b>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø¯Ø®Ù„:</b> ${type === "url" ? "Ø±Ø§Ø¨Ø· (URL)" : "Ù…Ù„Ù"}<br><br>
                ${riskLabel}
                <hr>
                ${details.join("<br>")}
            `;
        }
    </script>

</body>
</html>